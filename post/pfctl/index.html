<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>pfctl | Raz1ner</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://dev-coco.github.io/favicon.ico?v=1676058158733">
<link rel="stylesheet" href="https://dev-coco.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="PF 防火墙的配置命令。

补充说明
pfctl 命令是 PF 防火墙的配置命令，PF 防火墙 ( 全称：Packet Filter ) 是 UNIX LIKE 系统上进行 TCP/ip 流量过滤和网络地址转换的软件系统。PF 同样也能提供..." />
    <meta name="keywords" content="Linux命令" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://dev-coco.github.io">
        <img src="https://dev-coco.github.io/images/avatar.png?v=1676058158733" class="site-logo">
        <h1 class="site-title">Raz1ner</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/Featured-Software.html" class="site-nav">
            软件
          </a>
        
      
        
          <a href="/Online-Tools" class="site-nav">
            在线工具
          </a>
        
      
        
          <a href="/post/Linux-Command" class="site-nav">
            Linux命令
          </a>
        
      
        
          <a href="/Excel" class="site-nav">
            Excel教程
          </a>
        
      
        
          <a href="/post/Terms-and-Privacy" class="site-nav">
            隐私与条款
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/dev-coco" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      
    </div>
    <div class="site-footer">
      <span>Copyright © 2020-2023 Raz1ner - All Rights Reserved.</span> | <a class="rss" href="https://dev-coco.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">pfctl</h2>
            <div class="post-date">2022-02-02</div>
            
              <div class="feature-container" style="background-image: url('https://dev-coco.github.io/post-images/Linux-Command.png')">
              </div>
            
            <div class="post-content" v-pre>
              <p>PF 防火墙的配置命令。</p>
<!-- more -->
<h2 id="补充说明">补充说明</h2>
<p>pfctl 命令是 PF 防火墙的配置命令，PF 防火墙 ( 全称：Packet Filter ) 是 UNIX LIKE 系统上进行 TCP/ip 流量过滤和网络地址转换的软件系统。PF 同样也能提供 TCP/IP 流量的整形和控制，并且提供带宽控制和数据包优先集控制。PF 最早是由 Daniel Hartmeier 开发的，现在的开发和维护由 Daniel 和 openBSD 小组的其他成员负责。<br>
PF 防火墙的功能很多，本站只列举一些基本配置。</p>
<h3 id="激活">激活</h3>
<p>要激活 pf 并且使它在启动时调用配置文件，编辑<code>/etc/rc.conf</code>文件，修改配置 pf 的一行：</p>
<pre><code class="language-Shell">pf=yes
</code></pre>
<p>重启操作系统让配置生效。<br>
也可以通过 pfctl 程序启动和停止 pf：</p>
<pre><code class="language-Shell">pfctl -e
pfctl -d
</code></pre>
<p>注意这仅仅是启动和关闭 PF，实际它不会载入规则集，规则集要么在系统启动时载入，要在 PF 启动后通过命令单独载入。</p>
<h2 id="配置">配置</h2>
<p>系统引导到在 rc 脚本文件运行 PF 时 PF 从<code>/etc/pf.conf</code>文件载入配置规则。注意当<code>/etc/pf.conf</code>文件是默认配置文件，在系统调用 rc 脚本文件时，它仅仅是作为文本文件由 pfctl 装入并解释和插入 pf 的。对于一些应用来说，其他的规则集可以在系统引导后由其他文件载入。对于一些设计的非常好的 unix 程序，PF 提供了足够的灵活性。<br>
pf.conf 文件有 7 个部分：</p>
<ul>
<li>宏：用户定义的变量，包括 IP 地址，接口名称等等。</li>
<li>表：一种用来保存 IP 地址列表的结构。</li>
<li>选项：控制 PF 如何工作的变量。</li>
<li>整形：重新处理数据包，进行正常化和碎片整理。</li>
<li>排队：提供带宽控制和数据包优先级控制。</li>
<li>转换：控制网络地址转换和数据包重定向。</li>
<li>过滤规则：在数据包通过接口时允许进行选择性的过滤和阻止。</li>
</ul>
<p>除去宏和表，其他的段在配置文件中也应该按照这个顺序出现，尽管对于一些特定的应用并不是所有的段都是必须的。<br>
空行会被忽略，以#开头的行被认为是注释。</p>
<h3 id="控制">控制</h3>
<p>引导之后，PF 可以通过 pfctl 程序进行操作，以下是一些例子：</p>
<pre><code class="language-Shell">pfctl -f /etc/pf.conf  # 载入 pf.conf 文件
pfctl -nf /etc/pf.conf # 解析文件，但不载入
pfctl -Nf /etc/pf.conf # 只载入文件中的NAT规则
pfctl -Rf /etc/pf.conf # 只载入文件中的过滤规则
pfctl -sn # 显示当前的NAT规则
pfctl -sr # 显示当前的过滤规则
pfctl -ss # 显示当前的状态表
pfctl -si # 显示过滤状态和计数
pfctl -sa # 显示任何可显示的
</code></pre>
<p>完整的命令列表，请参阅 pfctl 的 man 手册页。</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://dev-coco.github.io/tag/linux-command/" class="tag">
                    Linux命令
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://dev-coco.github.io/post/iostat/">
                  <h3 class="post-title">
                    iostat
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>






  </body>
</html>
